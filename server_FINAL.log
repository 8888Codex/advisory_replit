
> rest-express@1.0.0 dev
> NODE_ENV=development tsx server/index.ts

[dotenv@17.2.3] injecting env (10) from .env -- tip: üîë add access controls to secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
5:20:11 PM [express] Starting Python backend on port 5002...
Seeding default experts...
Seeded 6 experts successfully.
5:20:11 PM [express] serving on port 3001
5:20:12 PM [express] [Python Backend Error] INFO:     Will watch for changes in these directories: ['/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend']
INFO:     Uvicorn running on http://0.0.0.0:5002 (Press CTRL+C to quit)
INFO:     Started reloader process [4904] using WatchFiles
5:20:13 PM [express] [Python Backend Error] INFO:     Started server process [4907]
5:20:13 PM [express] [Python Backend Error] INFO:     Waiting for application startup.
5:20:13 PM [express] [Python Backend Error] INFO:     Application startup complete.
5:20:43 PM [express] [Python Backend] [CloneRegistry] Discovering seed clones...
[CloneRegistry] Registered SEED clone: Al Ries (5 stories)
[CloneRegistry] Registered SEED clone: Ann Handley (5 stories)
[CloneRegistry] Registered SEED clone: Claude Hopkins (5 stories)
[CloneRegistry] Registered SEED clone: Dan Kennedy (5 stories)
[CloneRegistry] Registered SEED clone: Daniel Kahneman (5 stories)
[CloneRegistry] Registered SEED clone: David Aaker (5 stories)
[CloneRegistry] Registered SEED clone: David Ogilvy (5 stories)
[CloneRegistry] Registered SEED clone: Donald Miller (5 stories)
[CloneRegistry] Registered SEED clone: Drayton Bird (5 stories)
[CloneRegistry] Registered SEED clone: Eugene Schwartz (5 stories)
[CloneRegistry] Registered SEED clone: Gary Vaynerchuk (5 stories)
[CloneRegistry] Registered SEED clone: Jay Abraham (5 stories)
[CloneRegistry] Registered SEED clone: Jay Levinson (5 stories)
[CloneRegistry] Registered SEED clone: Neil Patel (5 stories)
[CloneRegistry] Registered SEED clone: Philip Kotler (5 stories)
[CloneRegistry] Registered SEED clone: Robert Cialdini (5 stories)
[CloneRegistry] Registered SEED clone: Seth Godin (5 stories)
[CloneRegistry] Registered SEED clone: Simon Sinek (5 stories)
[CloneRegistry] Discovering custom auto-generated clones...
[CORS] Allowed origins: ['http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:5000', 'http://127.0.0.1:5000']
[Startup] Initializing PostgreSQL storage...
[PostgresStorage] Connection pool initialized
[Startup] PostgreSQL storage initialized successfully
[Startup] Seed experts loaded from CloneRegistry. PostgreSQL ready for custom experts.
INFO:     127.0.0.1:60048 - "GET /health HTTP/1.1" 404 Not Found
Browserslist: browsers data (caniuse-lite) is 13 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme

A PostCSS plugin did not pass the `from` option to `postcss.parse`. This may cause imported assets to be incorrectly transformed. If you've recently added a PostCSS plugin that raised this warning, please contact the package author to fix the issue.
(node:4894) [DEP0060] DeprecationWarning: The `util._extend` API is deprecated. Please use Object.assign() instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
5:21:56 PM [express] [Python Backend] [ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:60328 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:21:56 PM [express] [Python Backend] [DEDUP] SEED experts: 18, DB experts: 1, Unique DB: 1
[DEBUG] Total experts loaded: 19
INFO:     127.0.0.1:60329 - "GET /api/experts HTTP/1.1" 200 OK
5:21:56 PM [express] [Python Backend] INFO:     127.0.0.1:60330 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:21:57 PM [express] [Python Backend] [PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'IA', 'companySize': '1-10', 'targetAudience': 'Empresas de servi√ßos que utilizam estrat√©gias de inbound para capta√ß√£o de cliente\n\n', 'goals': ['growth'], 'mainChallenge': 'Preciso trazer mais clientes para minha esteira de vendas, uso estrat√©gia de inbound, mas nao estou conseguindo lotar a agenda do meu time comercial ', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 19, 48, 18, 63933)}
INFO:     127.0.0.1:60330 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:21:57 PM [express] [Python Backend] INFO:     127.0.0.1:60328 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:22:03 PM [express] [Python Backend] INFO:     127.0.0.1:60347 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:22:03 PM [express] [Python Backend] INFO:     127.0.0.1:60346 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:22:10 PM [express] [Python Backend] [HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 16 conversations
[HISTORY] Returning 16 conversations with details
INFO:     127.0.0.1:60376 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
5:22:15 PM [express] [Python Backend] INFO:     127.0.0.1:60397 - "GET /api/experts/seed-dan-kennedy HTTP/1.1" 200 OK
5:22:15 PM [express] [Python Backend] INFO:     127.0.0.1:60398 - "GET /api/conversations/d92f83e8-5f02-46dc-be8c-a70f4e780cd6/messages HTTP/1.1" 200 OK
5:22:21 PM [express] [Python Backend] [DEDUP] SEED experts: 18, DB experts: 1, Unique DB: 1
INFO:     127.0.0.1:60412 - "GET /api/categories HTTP/1.1" 200 OK
5:22:22 PM [express] [Python Backend] INFO:     127.0.0.1:60399 - "GET /api/experts/seed-dan-kennedy/suggested-questions HTTP/1.1" 200 OK
5:22:24 PM [express] [Python Backend] [DEBUG] Getting experts, category filter: marketing
INFO:     127.0.0.1:60422 - "GET /api/experts/recommendations HTTP/1.1" 200 OK
5:22:24 PM [express] [Python Backend] [DEDUP] SEED experts: 18, DB experts: 1, Unique DB: 1
[DEBUG] Total experts loaded: 19
[DEBUG] After category filter: 4
INFO:     127.0.0.1:60421 - "GET /api/experts?category=marketing HTTP/1.1" 200 OK
5:22:42 PM [express] [Python Backend] [DEBUG] Getting experts, category filter: direct_response
[DEDUP] SEED experts: 18, DB experts: 1, Unique DB: 1
[DEBUG] Total experts loaded: 19
[DEBUG] After category filter: 4
INFO:     127.0.0.1:60469 - "GET /api/experts?category=direct_response HTTP/1.1" 200 OK
5:22:45 PM [express] [Python Backend] [DEBUG] Creating conversation for user 48bb3e53-bfca-4298-bab5-1627ca216739 with data: expertId='seed-dan-kennedy' title='Conversa com Dan Kennedy'
[DEBUG] Getting expert: seed-dan-kennedy
[DEBUG] Expert found: Dan Kennedy
[DEBUG] Calling storage.create_conversation...
[DEBUG] Conversation created: 0b0a25ef-f832-46e9-8c55-19b95cbfac89
INFO:     127.0.0.1:60489 - "POST /api/conversations?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 201 Created
5:22:45 PM [express] [Python Backend] INFO:     127.0.0.1:60491 - "GET /api/conversations/0b0a25ef-f832-46e9-8c55-19b95cbfac89/messages HTTP/1.1" 200 OK
5:23:09 PM [express] [Python Backend] [CHAT] Expert Dan Kennedy systemPrompt length: 19161 chars
[CHAT] Building ENRICHED persona context for Codex
[CHAT] Persona context ready: 2345 chars
[LegendAgentFactory] Loaded rich clone for Dan Kennedy + PERSONA CONTEXT (2345 chars)
INFO:     127.0.0.1:60505 - "POST /api/conversations/0b0a25ef-f832-46e9-8c55-19b95cbfac89/messages HTTP/1.1" 201 Created
5:23:09 PM [express] [Python Backend] INFO:     127.0.0.1:60534 - "GET /api/conversations/0b0a25ef-f832-46e9-8c55-19b95cbfac89/messages HTTP/1.1" 200 OK
5:23:52 PM [express] [Python Backend] INFO:     127.0.0.1:60608 - "GET /api/persona/7b658cd1-7ab4-4587-8937-b5f8f289e5db?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:25:19 PM [express] [Python Backend] [ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:60814 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:25:19 PM [express] [Python Backend] INFO:     127.0.0.1:60815 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:25:19 PM [express] [Python Backend] [DEBUG] Getting experts, category filter: None
[DEDUP] SEED experts: 18, DB experts: 1, Unique DB: 1
INFO:     127.0.0.1:60819 - "GET /api/categories HTTP/1.1" 200 OK
5:25:19 PM [express] [Python Backend] [DEDUP] SEED experts: 18, DB experts: 1, Unique DB: 1
[DEBUG] Total experts loaded: 19
INFO:     127.0.0.1:60820 - "GET /api/experts HTTP/1.1" 200 OK
5:25:30 PM [express] [Python Backend] [HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 17 conversations
[HISTORY] Returning 17 conversations with details
INFO:     127.0.0.1:60842 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
5:25:35 PM [express] [Python Backend] [CLEAR-ALL] User 48bb3e53-bfca-4298-bab5-1627ca216739 clearing all conversations
[CLEAR-ALL] Deleted 17 conversations for user 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:60867 - "DELETE /api/conversations/user/clear-all?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
5:25:35 PM [express] [Python Backend] [HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 0 conversations
[HISTORY] Returning 0 conversations with details
INFO:     127.0.0.1:60867 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
5:25:37 PM [express] [Python Backend Error] WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
5:25:37 PM [express] [Python Backend Error] INFO:     Shutting down
5:25:37 PM [express] [Python Backend Error] INFO:     Waiting for application shutdown.
5:25:37 PM [express] [Python Backend Error] INFO:     Application shutdown complete.
5:25:37 PM [express] [Python Backend Error] INFO:     Finished server process [4907]
5:25:38 PM [express] [Python Backend Error] INFO:     Started server process [5273]
5:25:38 PM [express] [Python Backend Error] INFO:     Waiting for application startup.
5:25:39 PM [express] [Python Backend Error] INFO:     Application startup complete.
5:25:40 PM [express] [Python Backend Error] WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
5:25:40 PM [express] [Python Backend Error] INFO:     Shutting down
5:25:40 PM [express] [Python Backend Error] INFO:     Waiting for application shutdown.
5:25:41 PM [express] [Python Backend Error] INFO:     Application shutdown complete.
5:25:41 PM [express] [Python Backend Error] INFO:     Finished server process [5273]
5:25:41 PM [express] [Python Backend Error] INFO:     Started server process [5276]
5:25:41 PM [express] [Python Backend Error] INFO:     Waiting for application startup.
5:25:41 PM [express] [Python Backend Error] INFO:     Application startup complete.
