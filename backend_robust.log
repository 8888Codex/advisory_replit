INFO:     Started server process [27590]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:5001 (Press CTRL+C to quit)
[CloneRegistry] Discovering seed clones...
[CloneRegistry] Registered SEED clone: Al Ries (5 stories)
[CloneRegistry] Registered SEED clone: Ann Handley (5 stories)
[CloneRegistry] Registered SEED clone: Claude Hopkins (5 stories)
[CloneRegistry] Registered SEED clone: Dan Kennedy (5 stories)
[CloneRegistry] Registered SEED clone: Daniel Kahneman (5 stories)
[CloneRegistry] Registered SEED clone: David Aaker (5 stories)
[CloneRegistry] Registered SEED clone: David Ogilvy (5 stories)
[CloneRegistry] Registered SEED clone: Donald Miller (5 stories)
[CloneRegistry] Registered SEED clone: Drayton Bird (5 stories)
[CloneRegistry] Registered SEED clone: Eugene Schwartz (5 stories)
[CloneRegistry] Registered SEED clone: Gary Vaynerchuk (5 stories)
[CloneRegistry] Registered SEED clone: Jay Abraham (5 stories)
[CloneRegistry] Registered SEED clone: Jay Levinson (5 stories)
[CloneRegistry] Registered SEED clone: Neil Patel (5 stories)
[CloneRegistry] Registered SEED clone: Philip Kotler (5 stories)
[CloneRegistry] Registered SEED clone: Robert Cialdini (5 stories)
[CloneRegistry] Registered SEED clone: Seth Godin (5 stories)
[CloneRegistry] Registered SEED clone: Simon Sinek (5 stories)
[CloneRegistry] Discovering custom auto-generated clones...
[CORS] Allowed origins: ['http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:5000', 'http://127.0.0.1:5000']
[Startup] Initializing PostgreSQL storage...
[PostgresStorage] Connection pool initialized
[Startup] PostgreSQL storage initialized successfully
[Startup] Seed experts loaded from CloneRegistry. PostgreSQL ready for custom experts.
INFO:     127.0.0.1:65046 - "GET / HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:65059 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[ENRICH_ENDPOINT] Received enrichment request for persona adc8b11a-7ebf-412b-9abf-87886ecc5ff1 with mode complete
[ENRICH_ENDPOINT] Persona found. Adding background task...
[ENRICH_ENDPOINT] Background task added successfully. Returning 202 response.
INFO:     127.0.0.1:65061 - "POST /api/persona/enrich/background HTTP/1.1" 202 Accepted
[BACKGROUND] ðŸ”§ Sync wrapper called for persona adc8b11a-7ebf-412b-9abf-87886ecc5ff1
[BACKGROUND] âš¡ Async enrichment task STARTED for persona adc8b11a-7ebf-412b-9abf-87886ecc5ff1 with level complete
[BACKGROUND] Creating database connection...
[BACKGROUND] Updating status to 'processing'...
[BACKGROUND] Status updated. Starting complete enrichment...
[BACKGROUND] Fetching persona data...
[BACKGROUND] Persona found. Starting COMPLETE enrichment...
[BACKGROUND] Company: Cognita AI
[BACKGROUND] Industry: InteligÃªncia Artificial
[BACKGROUND] Level: complete
[BACKGROUND] Calling COMPLETE enrichment (YouTube + 8 modules)...
[STANDALONE ENRICHMENT] Starting COMPLETE enrichment...
[STANDALONE ENRICHMENT] Company: Cognita AI
[STANDALONE ENRICHMENT] Industry: InteligÃªncia Artificial
[STANDALONE ENRICHMENT] Phase 1: YouTube Research...
[YOUTUBE] Searching: InteligÃªncia Artificial marketing strategy
[YOUTUBE] Searching: Empresas B2B de tecnologia buyer persona
[YOUTUBE] Found 10 videos
[YOUTUBE] Warning: Expecting value: line 1 column 1 (char 0)
[STANDALONE ENRICHMENT] Phase 2: Generating Deep Modules...
[MODULES] Generating: psychographicCore...
[DB] Saved psychographicCore to database
[MODULES] Generating: buyerJourney...
[DB] Saved buyerJourney to database
[MODULES] Generating: behavioralProfile...
[DB] Saved behavioralProfile to database
[MODULES] Generating: languageCommunication...
[DB] Saved languageCommunication to database
[MODULES] Generating: strategicInsights...
[DB] Saved strategicInsights to database
[MODULES] Generating: jobsToBeDone...
[DB] Saved jobsToBeDone to database
[MODULES] Generating: decisionProfile...
[DB] Saved decisionProfile to database
[MODULES] Generating: copyExamples...
[DB] Saved copyExamples to database
[STANDALONE ENRICHMENT] Phase 3: Base Fields...
[STANDALONE ENRICHMENT] âœ… Enrichment COMPLETE!
[STANDALONE ENRICHMENT] Modules generated: 10
[STANDALONE ENRICHMENT] YouTube videos: 0
[BACKGROUND] âœ… Enrichment COMPLETE!
[BACKGROUND] Generated modules: ['youtube', 'psychographicCore', 'buyerJourney', 'behavioralProfile', 'languageCommunication', 'strategicInsights', 'jobsToBeDone', 'decisionProfile', 'copyExamples', 'baseFields']
[BACKGROUND] YouTube videos: 0
[BACKGROUND] Enrichment completed, marking as 'completed'...
[BACKGROUND] âœ… Enrichment completed successfully!
[BACKGROUND] Database connection closed
INFO:     127.0.0.1:65115 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65117 - "DELETE /api/persona/adc8b11a-7ebf-412b-9abf-87886ecc5ff1?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 204 No Content
INFO:     127.0.0.1:65119 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CREATE] Endpoint called with data: companyName='Teste Nova Empresa' industry='Tecnologia' companySize='11-50' targetAudience='Startups de SaaS' mainProducts=None channels=['social', 'paid'] budgetRange=None primaryGoal='AquisiÃ§Ã£o' mainChallenge='ConversÃ£o' timeline=None researchMode='strategic' enrichmentLevel='quick' additionalContext=None
[PERSONA CREATE] Using user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CREATE] Calling storage.create_user_persona...
[PERSONA CREATE] Persona created successfully: 2c893d3f-7108-4d7a-9423-5fdbe620fc0e
INFO:     127.0.0.1:65121 - "POST /api/persona/create?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 201 Created
INFO:     127.0.0.1:65123 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CREATE] Endpoint called with data: companyName='Cognita AI - Gabriel Lima' industry='InteligÃªncia Artificial' companySize='1-10' targetAudience='Empresas B2B de tecnologia' mainProducts=None channels=['social', 'email', 'content'] budgetRange=None primaryGoal='Crescimento e Leads' mainChallenge='Gerar leads qualificados' timeline=None researchMode='strategic' enrichmentLevel='complete' additionalContext=None
[PERSONA CREATE] Using user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CREATE] Calling storage.create_user_persona...
[PERSONA CREATE] Persona created successfully: 2c893d3f-7108-4d7a-9423-5fdbe620fc0e
INFO:     127.0.0.1:65138 - "POST /api/persona/create?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 201 Created
[ENRICH_ENDPOINT] Received enrichment request for persona 2c893d3f-7108-4d7a-9423-5fdbe620fc0e with mode complete
[ENRICH_ENDPOINT] Persona found. Adding background task...
[ENRICH_ENDPOINT] Background task added successfully. Returning 202 response.
INFO:     127.0.0.1:65140 - "POST /api/persona/enrich/background HTTP/1.1" 202 Accepted
[BACKGROUND] ðŸ”§ Sync wrapper called for persona 2c893d3f-7108-4d7a-9423-5fdbe620fc0e
[BACKGROUND] âš¡ Async enrichment task STARTED for persona 2c893d3f-7108-4d7a-9423-5fdbe620fc0e with level complete
[BACKGROUND] Creating database connection...
[BACKGROUND] Updating status to 'processing'...
[BACKGROUND] Status updated. Starting complete enrichment...
[BACKGROUND] Fetching persona data...
[BACKGROUND] Persona found. Starting COMPLETE enrichment...
[BACKGROUND] Company: Cognita AI - Gabriel Lima
[BACKGROUND] Industry: InteligÃªncia Artificial
[BACKGROUND] Level: complete
[BACKGROUND] Calling COMPLETE enrichment (YouTube + 8 modules)...
[STANDALONE ENRICHMENT] Starting COMPLETE enrichment...
[STANDALONE ENRICHMENT] Company: Cognita AI - Gabriel Lima
[STANDALONE ENRICHMENT] Industry: InteligÃªncia Artificial
[STANDALONE ENRICHMENT] Phase 1: YouTube Research...
[YOUTUBE] Searching: InteligÃªncia Artificial marketing strategy
[YOUTUBE] Searching: Empresas B2B de tecnologia buyer persona
[YOUTUBE] Found 10 videos
[YOUTUBE] Warning: Expecting value: line 1 column 1 (char 0)
[STANDALONE ENRICHMENT] Phase 2: Generating Deep Modules...
[MODULES] Generating: psychographicCore...
[DB] Saved psychographicCore to database
[MODULES] Generating: buyerJourney...
[DB] Saved buyerJourney to database
[MODULES] Generating: behavioralProfile...
[DB] Saved behavioralProfile to database
[MODULES] Generating: languageCommunication...
[DB] Saved languageCommunication to database
[MODULES] Generating: strategicInsights...
[DB] Saved strategicInsights to database
[MODULES] Generating: jobsToBeDone...
[DB] Saved jobsToBeDone to database
[MODULES] Generating: decisionProfile...
[DB] Saved decisionProfile to database
[MODULES] Generating: copyExamples...
[DB] Saved copyExamples to database
[STANDALONE ENRICHMENT] Phase 3: Base Fields...
[STANDALONE ENRICHMENT] âœ… Enrichment COMPLETE!
[STANDALONE ENRICHMENT] Modules generated: 10
[STANDALONE ENRICHMENT] YouTube videos: 0
[BACKGROUND] âœ… Enrichment COMPLETE!
[BACKGROUND] Generated modules: ['youtube', 'psychographicCore', 'buyerJourney', 'behavioralProfile', 'languageCommunication', 'strategicInsights', 'jobsToBeDone', 'decisionProfile', 'copyExamples', 'baseFields']
[BACKGROUND] YouTube videos: 0
[BACKGROUND] Enrichment completed, marking as 'completed'...
[BACKGROUND] âœ… Enrichment completed successfully!
[BACKGROUND] Database connection closed
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:65285 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:65285 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65286 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65295 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:65294 - "GET /api/experts HTTP/1.1" 200 OK
INFO:     127.0.0.1:65318 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65317 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65375 - "GET /api/persona/2c893d3f-7108-4d7a-9423-5fdbe620fc0e?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:65434 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65433 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65433 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65434 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:65433 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:65433 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:65459 - "GET /api/experts HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
INFO:     127.0.0.1:65493 - "GET /api/categories HTTP/1.1" 200 OK
INFO:     127.0.0.1:65534 - "DELETE /api/persona/2c893d3f-7108-4d7a-9423-5fdbe620fc0e?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 204 No Content
[Analytics] Error getting overview: column "metadata" does not exist
INFO:     127.0.0.1:49167 - "GET /api/analytics/overview HTTP/1.1" 500 Internal Server Error
[Analytics] Error getting category distribution: column ua.metadata does not exist
INFO:     127.0.0.1:49170 - "GET /api/analytics/categories HTTP/1.1" 500 Internal Server Error
[Analytics] Error getting top experts: column ua.metadata does not exist
INFO:     127.0.0.1:49174 - "GET /api/analytics/top-experts HTTP/1.1" 500 Internal Server Error
[Analytics] Error generating recommendations: column "metadata" does not exist
INFO:     127.0.0.1:49179 - "GET /api/analytics/recommendations HTTP/1.1" 200 OK
INFO:     127.0.0.1:49177 - "GET /api/analytics/timeline HTTP/1.1" 200 OK
[HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 4 conversations
[HISTORY] Returning 4 conversations with details
INFO:     127.0.0.1:49253 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
[DELETE] User 48bb3e53-bfca-4298-bab5-1627ca216739 deleting conversation 0452bf21-6391-433b-b554-439723f4cf87
[DELETE] Conversation 0452bf21-6391-433b-b554-439723f4cf87 deleted successfully
INFO:     127.0.0.1:49265 - "DELETE /api/conversations/0452bf21-6391-433b-b554-439723f4cf87?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 3 conversations
[HISTORY] Returning 3 conversations with details
INFO:     127.0.0.1:49265 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
[CLEAR-ALL] User 48bb3e53-bfca-4298-bab5-1627ca216739 clearing all conversations
[CLEAR-ALL] Deleted 3 conversations for user 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:49265 - "DELETE /api/conversations/user/clear-all?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 0 conversations
[HISTORY] Returning 0 conversations with details
INFO:     127.0.0.1:49265 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49279 - "GET /api/experts/recommendations HTTP/1.1" 200 OK
INFO:     127.0.0.1:49387 - "DELETE /api/persona/2c893d3f-7108-4d7a-9423-5fdbe620fc0e?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:49438 - "GET / HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:49442 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CREATE] Endpoint called with data: companyName='Cognita AI - Gabriel Lima' industry='InteligÃªncia Artificial' companySize='1-10' targetAudience='Empresas B2B de tecnologia' mainProducts=None channels=['social', 'email', 'content'] budgetRange=None primaryGoal='Crescimento e Leads' mainChallenge='Gerar leads qualificados' timeline=None researchMode='strategic' enrichmentLevel='complete' additionalContext=None
[PERSONA CREATE] Using user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CREATE] Calling storage.create_user_persona...
[PERSONA CREATE] Persona created successfully: b4f7d65b-6f7a-4662-8246-df47100acfe0
INFO:     127.0.0.1:49471 - "POST /api/persona/create?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 201 Created
[ENRICH_ENDPOINT] Received enrichment request for persona b4f7d65b-6f7a-4662-8246-df47100acfe0 with mode quick
[ENRICH_ENDPOINT] Persona found. Adding background task...
[ENRICH_ENDPOINT] Background task added successfully. Returning 202 response.
INFO:     127.0.0.1:49474 - "POST /api/persona/enrich/background HTTP/1.1" 202 Accepted
[BACKGROUND] ðŸ”§ Sync wrapper called for persona b4f7d65b-6f7a-4662-8246-df47100acfe0
[BACKGROUND] âš¡ Async enrichment task STARTED for persona b4f7d65b-6f7a-4662-8246-df47100acfe0 with level quick
[BACKGROUND] Creating database connection...
[BACKGROUND] Updating status to 'processing'...
[BACKGROUND] Status updated. Starting quick enrichment...
[BACKGROUND] Fetching persona data...
[BACKGROUND] Persona found. Starting COMPLETE enrichment...
[BACKGROUND] Company: Cognita AI - Gabriel Lima
[BACKGROUND] Industry: InteligÃªncia Artificial
[BACKGROUND] Level: quick
[BACKGROUND] Calling COMPLETE enrichment (YouTube + 8 modules)...
[STANDALONE ENRICHMENT] Starting QUICK enrichment...
[STANDALONE ENRICHMENT] Company: Cognita AI - Gabriel Lima
[STANDALONE ENRICHMENT] Industry: InteligÃªncia Artificial
[STANDALONE ENRICHMENT] Phase 1: YouTube Research...
[YOUTUBE] Searching: InteligÃªncia Artificial marketing strategy
[YOUTUBE] Searching: Empresas B2B de tecnologia buyer persona
[YOUTUBE] Found 10 videos
[YOUTUBE] Warning: Expecting value: line 1 column 1 (char 0)
[STANDALONE ENRICHMENT] Phase 2: Generating Deep Modules...
[MODULES] Generating: psychographicCore...
[DB] Saved psychographicCore to database
[MODULES] Generating: buyerJourney...
[DB] Saved buyerJourney to database
[MODULES] Generating: strategicInsights...
[DB] Saved strategicInsights to database
[STANDALONE ENRICHMENT] Phase 3: Base Fields...
[STANDALONE ENRICHMENT] âœ… Enrichment COMPLETE!
[STANDALONE ENRICHMENT] Modules generated: 5
[STANDALONE ENRICHMENT] YouTube videos: 0
[BACKGROUND] âœ… Enrichment COMPLETE!
[BACKGROUND] Generated modules: ['youtube', 'psychographicCore', 'buyerJourney', 'strategicInsights', 'baseFields']
[BACKGROUND] YouTube videos: 0
[BACKGROUND] Enrichment completed, marking as 'completed'...
[BACKGROUND] âœ… Enrichment completed successfully!
[BACKGROUND] Database connection closed
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:49495 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:49568 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49569 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49568 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49569 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49593 - "POST /api/auth/login HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:49595 - "POST /api/audit/log HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 421, in create_audit_log
    log_id = await storage.create_audit_log(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 1370, in create_audit_log
    await conn.execute("""
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "metadata" of relation "audit_logs" does not exist
INFO:     127.0.0.1:49610 - "POST /api/auth/generate-invite HTTP/1.1" 404 Not Found
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:49746 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49745 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49745 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49746 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49813 - "POST /api/auth/login HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:49815 - "POST /api/audit/log HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 421, in create_audit_log
    log_id = await storage.create_audit_log(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 1370, in create_audit_log
    await conn.execute("""
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "metadata" of relation "audit_logs" does not exist
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:49834 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49836 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49834 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49836 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49834 - "POST /api/audit/log HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 421, in create_audit_log
    log_id = await storage.create_audit_log(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 1370, in create_audit_log
    await conn.execute("""
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "metadata" of relation "audit_logs" does not exist
INFO:     127.0.0.1:49867 - "POST /api/auth/login HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:49869 - "POST /api/audit/log HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 421, in create_audit_log
    log_id = await storage.create_audit_log(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 1370, in create_audit_log
    await conn.execute("""
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "metadata" of relation "audit_logs" does not exist
INFO:     127.0.0.1:49877 - "POST /api/auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:49879 - "POST /api/audit/log HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 389, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/fastapi/routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 421, in create_audit_log
    log_id = await storage.create_audit_log(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 1370, in create_audit_log
    await conn.execute("""
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 352, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2012, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "metadata" of relation "audit_logs" does not exist
INFO:     127.0.0.1:49877 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:49877 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting experts, category filter: None
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:49888 - "GET /api/experts HTTP/1.1" 200 OK
INFO:     127.0.0.1:49886 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[set_active_persona] Update result: 'UPDATE 1' (type: <class 'str'>)
[set_active_persona] Success: True
INFO:     127.0.0.1:49973 - "POST /api/persona/set-active?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49973 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49973 - "GET /api/persona/b4f7d65b-6f7a-4662-8246-df47100acfe0?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50006 - "DELETE /api/persona/b4f7d65b-6f7a-4662-8246-df47100acfe0?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 204 No Content
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:50006 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50154 - "DELETE /api/persona/b4f7d65b-6f7a-4662-8246-df47100acfe0?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50231 - "DELETE /api/persona/b4f7d65b-6f7a-4662-8246-df47100acfe0?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 404 Not Found
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:50249 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50250 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50249 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50250 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:50249 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting experts, category filter: None
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:50249 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:50275 - "GET /api/experts HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:50438 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50437 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:50438 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:50437 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:50444 - "GET /api/experts HTTP/1.1" 200 OK
INFO:     127.0.0.1:50437 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50438 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:50759 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50760 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:50760 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50759 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:50766 - "GET /api/experts HTTP/1.1" 200 OK
INFO:     127.0.0.1:50759 - "GET /api/persona/list?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50760 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:50937 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50936 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:50936 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:50949 - "GET /api/experts HTTP/1.1" 200 OK
INFO:     127.0.0.1:50936 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
INFO:     127.0.0.1:50986 - "GET /api/categories HTTP/1.1" 200 OK
[HISTORY] Getting conversation history for user: 48bb3e53-bfca-4298-bab5-1627ca216739, limit: 50
[HISTORY] Found 0 conversations
[HISTORY] Returning 0 conversations with details
INFO:     127.0.0.1:51004 - "GET /api/conversations/history/user?user_id=48bb3e53-bfca-4298-bab5-1627ca216739&limit=50 HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:51030 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51029 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:51030 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:51030 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:51042 - "GET /api/experts HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:51179 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51181 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:51179 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:51179 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:51193 - "GET /api/experts HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:51308 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51309 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:51308 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:51308 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:51333 - "GET /api/experts HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:51430 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51431 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:51431 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Getting experts, category filter: None
INFO:     127.0.0.1:51431 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:51455 - "GET /api/experts HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:52465 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52466 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting experts, category filter: None
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CURRENT] Fetching persona for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:52465 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEDUP] SEED experts: 18, DB experts: 22, Unique DB: 14
[DEDUP] Removed 8 duplicate(s) from DB (already in SEED)
[DEBUG] Total experts loaded: 32
INFO:     127.0.0.1:52472 - "GET /api/experts HTTP/1.1" 200 OK
INFO:     127.0.0.1:52466 - "GET /api/persona/current?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[ENRICHMENT STATUS] Fetching for user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
INFO:     127.0.0.1:52491 - "GET /api/persona/enrichment-status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52493 - "GET /api/auth/me?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Getting onboarding status for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Onboarding status found: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'InteligÃªncia Artificial', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os e Saas, que usa estratÃ©gias de inbound para captar lead para o time comercial e tem pelo menos 3 pessoas no time', 'goals': ['growth'], 'mainChallenge': 'Estou baixa entrada de lead no meu funil, preciso melhorar a aquisÃ§Ã£o de clientes, nÃ£o consigo lotar a agenda do meu vendedor', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133)}
INFO:     127.0.0.1:52491 - "GET /api/onboarding/status?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Saving onboarding for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Data received: currentStep=1 companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='' goals=None mainChallenge='' enrichmentLevel='quick'
[DEBUG] Onboarding data dict: {'currentStep': 1, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': '', 'mainChallenge': '', 'enrichmentLevel': 'quick'}
[DEBUG] Save result: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 1, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': '', 'goals': ['growth'], 'mainChallenge': '', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 5, 11, 56, 501466)}
INFO:     127.0.0.1:52515 - "POST /api/onboarding/save?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Saving onboarding for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Data received: currentStep=2 companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas' goals=None mainChallenge='' enrichmentLevel='quick'
[DEBUG] Onboarding data dict: {'currentStep': 2, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'mainChallenge': '', 'enrichmentLevel': 'quick'}
[DEBUG] Save result: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 2, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': '', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 5, 12, 44, 964803)}
INFO:     127.0.0.1:52532 - "POST /api/onboarding/save?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Saving onboarding for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Data received: currentStep=3 companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas' goals=['growth'] mainChallenge='NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas' enrichmentLevel='quick'
[DEBUG] Onboarding data dict: {'currentStep': 3, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': 'NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas', 'enrichmentLevel': 'quick'}
[DEBUG] Save result: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 3, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': 'NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 5, 13, 8, 151144)}
INFO:     127.0.0.1:52542 - "POST /api/onboarding/save?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
[DEBUG] Saving onboarding for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Data received: currentStep=4 companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas' goals=['growth'] mainChallenge='NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas' enrichmentLevel='strategic'
[DEBUG] Onboarding data dict: {'currentStep': 4, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': 'NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas', 'enrichmentLevel': 'strategic'}
[DEBUG] Save result: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': 'NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas', 'enrichmentLevel': 'strategic', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 5, 13, 11, 718701)}
INFO:     127.0.0.1:52542 - "POST /api/onboarding/save?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 3018, in create_user_persona
    persona = await storage.create_user_persona(user_id, data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 608, in create_user_persona
    "role": row['role'],
      ^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 748, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2027, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidColumnReferenceError: there is no unique or exclusion constraint matching the ON CONFLICT specification
[PERSONA CREATE] Endpoint called with data: companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas' mainProducts=None channels=[] budgetRange=None primaryGoal='growth' mainChallenge='NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas' timeline=None researchMode='strategic' enrichmentLevel='strategic' additionalContext=None
[PERSONA CREATE] Using user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CREATE] Calling storage.create_user_persona...
[PERSONA CREATE] Error creating persona: there is no unique or exclusion constraint matching the ON CONFLICT specification
INFO:     127.0.0.1:52542 - "POST /api/persona/create?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 500 Internal Server Error
[DEBUG] Saving onboarding for user: 48bb3e53-bfca-4298-bab5-1627ca216739
[DEBUG] Data received: currentStep=4 companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas' goals=['growth'] mainChallenge='NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas' enrichmentLevel='quick'
[DEBUG] Onboarding data dict: {'currentStep': 4, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': 'NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas', 'enrichmentLevel': 'quick'}
[DEBUG] Save result: {'id': '6cb89662-7d11-42ac-a718-1e168d0f3a3a', 'userId': '48bb3e53-bfca-4298-bab5-1627ca216739', 'currentStep': 4, 'companyName': 'Codex', 'industry': 'Agencia de IA', 'companySize': '11-50', 'targetAudience': 'Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas', 'goals': ['growth'], 'mainChallenge': 'NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas', 'enrichmentLevel': 'quick', 'completedAt': datetime.datetime(2025, 11, 10, 2, 56, 46, 16133), 'createdAt': datetime.datetime(2025, 11, 10, 2, 55, 27, 876980), 'updatedAt': datetime.datetime(2025, 11, 10, 5, 13, 17, 409603)}
INFO:     127.0.0.1:52549 - "POST /api/onboarding/save?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/main.py", line 3018, in create_user_persona
    persona = await storage.create_user_persona(user_id, data)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/python_backend/storage.py", line 608, in create_user_persona
    "role": row['role'],
      ^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 748, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gabriellima/Downloads/Andromeda/advisory_replit/.venv/lib/python3.12/site-packages/asyncpg/connection.py", line 2027, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 206, in bind_execute
asyncpg.exceptions.InvalidColumnReferenceError: there is no unique or exclusion constraint matching the ON CONFLICT specification
[PERSONA CREATE] Endpoint called with data: companyName='Codex' industry='Agencia de IA' companySize='11-50' targetAudience='Empresas de serviÃ§os que utilizam estratÃ©gia de inbound marketing para captaÃ§Ã£o de cliente e tem pelo menos 3 pessoas no time de vendas' mainProducts=None channels=[] budgetRange=None primaryGoal='growth' mainChallenge='NÃ£o estou conseguindo atrair clientes com qualidade e lotar a agenda do meu time de vendas' timeline=None researchMode='strategic' enrichmentLevel='quick' additionalContext=None
[PERSONA CREATE] Using user_id: 48bb3e53-bfca-4298-bab5-1627ca216739
[PERSONA CREATE] Calling storage.create_user_persona...
[PERSONA CREATE] Error creating persona: there is no unique or exclusion constraint matching the ON CONFLICT specification
INFO:     127.0.0.1:52549 - "POST /api/persona/create?user_id=48bb3e53-bfca-4298-bab5-1627ca216739 HTTP/1.1" 500 Internal Server Error
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [27590]
