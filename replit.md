# AdvisorIA - Replit Agent Guide

## Overview
AdvisorIA is a premium AI consultancy platform offering expert advice through cognitive clones of 18 specialists across 15 disciplines. It leverages the "Framework EXTRACT de 12 Camadas" (now 20 points) with Anthropic's Claude to create ultra-realistic AI personalities. The platform features a React/TypeScript frontend, an Express.js proxy, and a Python/FastAPI backend with asynchronous AI integration, aiming to provide a specialized multi-category consulting experience. The platform's ambition is to consolidate 450+ years of marketing expertise into an accessible, interactive format, providing specialized, multi-category consulting.

## User Preferences
Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend
- **Framework & Tooling**: React 18 with TypeScript, Vite, Wouter for routing, TanStack Query v5 for server state.
- **UI Component System**: shadcn/ui components on Radix UI, Tailwind CSS for styling, with a professional dark-mode primary aesthetic (Apple-style minimalist design with a neutral palette and single accent coral color).
- **State Management**: TanStack Query for server state, React Context for theme, react-hook-form with Zod for forms.
- **Routing**: Wouter with custom `useURLSearchParam` hook for URL query parameter synchronization.

### Backend (Hybrid Proxy + Python)
- **Express.js Proxy Server (Port 5000)**: TypeScript proxy forwarding `/api` requests to Python backend, handles automatic Python backend startup and serves static frontend in production.
- **Python/FastAPI Backend (Port 5001)**: FastAPI for async API routes, AsyncAnthropic client for non-blocking AI calls.
- **API Endpoints**: Includes endpoints for experts, categories, suggested questions, chat, auto-cloning, user profiles, insights, and persona management (CRUD for `personas` table).
- **Storage Layer**: In-memory Python storage (MemStorage) using Pydantic models for Expert, Conversation, and Message entities.

### AI Integration - Cognitive Cloning
- **Framework EXTRACT de 20 Pontos**: Each specialist uses a 20-point cognitive fidelity framework for ultra-realistic personalities, covering identity, experiences (story banks), reasoning patterns, terminology, axioms, contexts, techniques, limitations, meta-awareness, quotes, real cases, controversial takes, behavioral triggers, iconic callbacks, and trigger reactions.
- **Implementation Architecture**:
    - **Rich Python Classes**: Each clone is a class inheriting from `ExpertCloneBase` (e.g., `python_backend/clones/{name}.py`).
    - **CloneRegistry**: Auto-discovery system dynamically loads all clones from the `clones/` directory.
    - **LegendAgentFactory Integration**: Loads rich clones first, falling back to legacy text prompts if a rich clone is not found.
    - **Validation**: Minimum requirements (e.g., 3 story banks, 3 iconic callbacks, 5 triggers) are enforced.
    - **Claude API**: AsyncAnthropic (claude-sonnet-4-20250514) processes dynamic system prompts generated by `get_system_prompt()`.
- **Specialists**: 18 specialists with cross-referencing capabilities and Socratic questioning for diagnostic interactions.

### Key Architectural Decisions
- **Monorepo Structure**: `/client` (React), `/server` (Express), `/python_backend` (FastAPI), and `/shared` (TypeScript types).
- **Data Flow**: User interaction -> React UI -> TanStack Query -> Express proxy -> FastAPI -> Storage/AsyncAnthropic -> FastAPI -> Express -> React.
- **Development Workflow**: `npm run dev` starts Express, which spawns the auto-reloading Python backend.
- **UX/UI Decisions**: Apple-style minimalist design with a neutral color palette (95% grays, 1 accent coral), subtle animations (200-300ms, cubic-bezier), `font-semibold` for headings, and standardized rounded-2xl corners.
- **Multi-Category Navigation System**: 15 distinct categories with consistent neutral iconography and filtering capabilities.
- **Personalization System**: Expert recommendations based on user profiles, contextual AI prompt enrichment, Perplexity-powered suggested questions, business insights, and smart filters.

## External Dependencies

- **Anthropic Claude API**: AI model interactions and cognitive cloning.
- **Perplexity API**: Research for auto-cloning feature and content generation.
- **React**: Frontend library.
- **Vite**: Build tool.
- **Wouter**: Client-side router.
- **TanStack Query**: Server state management.
- **shadcn/ui & Radix UI**: UI component libraries.
- **Tailwind CSS**: Styling framework.
- **Express.js**: Proxy server.
- **FastAPI**: Python backend framework.
- **AsyncAnthropic**: Asynchronous Python client for Anthropic API.
- **Uvicorn**: ASGI server for FastAPI.
- **Pydantic**: Data validation for Python models.
- **Zod**: Schema declaration and validation for TypeScript.
- **Framer Motion**: Animation library for React.
- **PostgreSQL**: Database for storing persona data.

## Cognitive Clone Migration Status

### âœ… Migration Complete (November 4, 2025)

**18/18 Clones Migrated to Rich Python Classes**

All marketing legends successfully migrated from text prompts to rich Python classes implementing the Framework EXTRACT de 20 Pontos:

1. âœ… Seth Godin - Purple Cow, Tribes, Permission Marketing
2. âœ… Philip Kotler - 4Ps, STP Framework, Marketing 3.0
3. âœ… David Ogilvy - Rolls-Royce headline, Consumer respect, Long copy
4. âœ… Gary Vaynerchuk - Day Trading Attention, Document Don't Create
5. âœ… Eugene Schwartz - Breakthrough Advertising, 5 Awareness Stages
6. âœ… Claude Hopkins - Scientific Advertising, Pepsodent campaign
7. âœ… Jay Abraham - 3 Ways to Grow, $9.4B Man, Parthenon Principles
8. âœ… Dan Kennedy - Magnetic Marketing, No BS, Time Vampires
9. âœ… Al Ries - Positioning, 22 Immutable Laws, First in Mind
10. âœ… Robert Cialdini - 6 Principles of Influence, Reciprocity
11. âœ… Donald Miller - StoryBrand SB7, Hero's Journey Marketing
12. âœ… Neil Patel - SEO + Content, Long-Form Wins, 3M+ monthly visits
13. âœ… David Aaker - Brand Equity Model, 5 Components Framework
14. âœ… Jay Levinson - Guerrilla Marketing, 200 Weapons, 21M+ copies sold
15. âœ… Ann Handley - Content Quality, Everybody Writes, Do Less and Obsess
16. âœ… Simon Sinek - Start With Why, Golden Circle, Think Different
17. âœ… Daniel Kahneman - Behavioral Economics, System 1/2, Nobel Prize 2002
18. âœ… Drayton Bird - Direct Response, Ogilvy ProtÃ©gÃ©, Â£1.5M campaigns

**Quality Standards Achieved (RIGOR TOTAL - November 4, 2025):**
- âœ… 5+ story banks com mÃ©tricas reais por clone (90 total story banks)
- âœ… 7+ iconic callbacks Ãºnicos por clone (126+ total)
- âœ… 15+ positive triggers por clone (270+ total)
- âœ… 15+ negative triggers por clone (270+ total)
- âœ… 5+ trigger reactions especÃ­ficas por clone (90+ total)
- âœ… 350+ linhas de system prompt por clone (6,300+ total)
- âœ… Framework EXTRACT de 20 pontos implementado completamente
- âœ… CloneRegistry validation: "18 clones registered, cada um com 5 stories"
- âœ… Zero fallbacks para legacy text prompts
- âœ… Testes comportamentais automatizados: 18/18 clones PASSED
- âœ… ConsolidaÃ§Ã£o de boilerplate: ~289 linhas de cÃ³digo duplicado eliminadas

**Technical Implementation:**
- Location: `python_backend/clones/*.py`
- Base Class: `ExpertCloneBase` (abstract class com Framework EXTRACT, auto-initialization)
- Registry: `CloneRegistry` auto-discovery system
- Validation: Minimum 5 stories, 7 callbacks, 15 positive triggers, 15 negative triggers enforced
- Testing: `python_backend/tests/test_clones_behavioral.py` (automated behavioral validation)
- Integration: `LegendAgentFactory` loads rich clones first
- API: Claude Sonnet 4 (claude-sonnet-4-20250514) via AsyncAnthropic

**Code Quality Improvements (November 4, 2025):**
- âœ… Consolidada lÃ³gica de inicializaÃ§Ã£o no `ExpertCloneBase.__init__`
- âœ… Auto-population de story_banks, callbacks, triggers via `get_*()` methods
- âœ… Eliminadas ~289 linhas de boilerplate duplicado em 17 clones
- âœ… Cada clone __init__ agora tem ~15-17 linhas (antes: ~30-35 linhas)
- âœ… Validation atualizada para exigir 15+/15+ triggers (rigor total)

**Next Steps:**
- âœ… Legacy prompts preserved em `python_backend/prompts/legends.py` (backup)
- âœ… Rigor Total atingido: 15+/15+ triggers em TODOS os 18 clones
- âœ… Testes comportamentais automatizados implementados e validados
- ðŸ”„ Consider deprecating legacy fallback apÃ³s E2E validation completa
- ðŸ”„ Deduplicate trigger keywords para maximizar cobertura semÃ¢ntica
- ðŸ”„ Spot-audit trigger reactions com vocabulÃ¡rio expandido
- ðŸ”„ Documentar thresholds em contributor guidelines para futuros clones
- ðŸ”„ Auto-generation template for future clones
- ðŸ”„ Migration of `/api/experts` endpoint to rich clone data